# level_crossing_controller :railway_car::vertical_traffic_light:
A controller to emulate United Kingdom’s train level crossings, it includes train, car and pedestrian warning lights. Originally intended for DEO nano board.

The design strategy for the given code utilizes a combination of hardware description language (HDL) and a state machine concept to control a traffic light sequence. The code is written in VHDL (VHSIC Hardware Description Language) and makes use of the IEEE standard libraries for logic and numeric operations. The design is verified using a test bench that includes a clock process and a stimulus process.

The code begins with the declaration of an entity called "light_controller" which serves as the top-level description of the design. It includes generic parameters, in this case, "divide_ratio" which is used to set the frequency of the clkout signal to 2hz, and port declarations, which defines the inputs and outputs of the design.

The architecture of the design, labeled "Behavioral", contains the actual implementation of the design. It includes a signal "count" which serves as a counter to keep track of time in the state machine process, and a signal "state" which keeps track of the current state of the traffic light sequence. The architecture also includes two processes: "clock_generation" and "process".

The "clock_generation" process is responsible for generating the clkout signal, which serves as the clock for the state machine process. It uses the clkin signal as an input and a counter that counts the cycles of the clkin signal. The counter is incremented at each rising edge of the clkin signal and is reset when it reaches the value of the "divide_ratio" parameter, effectively generating a 2hz clock signal.

The "process" is the state machine process that controls the traffic light sequence. It is triggered by the clkout signal, and updates the state of the traffic light sequence based on the value of the "reset" signal and the current state. The state machine has 5 states (state_1, state_2, state_3, state_4, state_5) that correspond to different configurations of the traffic light sequence. The state machine uses the "count" signal to keep track of time, and the "state" signal to keep track of the current state. The below timeline table has been used to track the 5 different states and to design the code. This timeline is inspired by a video from UK Level Crossings Channel and by combining the train crossings at Billingshurst Level Crossing East Sussex (11 minutes 28 seconds into the video) and Farnborough North Level Crossing northeast Hampshire (49 minutes 55 seconds in the video) , to implement red and green pedestrian lights. The real times have been reduced to fit in a ≈ 30 second video.

Finally, the code includes the declarations for the output signals, which correspond to the different lights in the traffic light sequence (led_amber_car, led_red_car_1, led_red_car_2, led_red_ped, led_green_ped, led_red_train, led_green_train). These signals are connected to the state machine process and are updated according to the current state.

To test the design, a testbench is created, which instantiates the design under test and includes two processes "clock_process" and "stim_process". The clock_process generates a clock signal to drive the design, while the stim_process applies input stimulus to the design, such as reset and start signals. The testbench allows the designer to verify that the design functions as expected under different scenarios.

In summary, the design strategy for the given code utilizes a state machine concept to control a traffic light sequence and a hardware description language (HDL) to describe the design in a hardware-oriented way. The code makes use of the standard libraries for logic and numeric operations, and the architecture of the design includes a clock generation process and a state machine process that controls the traffic light sequence. The design is verified using a testbench that includes a clock process and a stimulus process.
